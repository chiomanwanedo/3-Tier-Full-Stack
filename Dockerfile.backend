# ---- build & run (simple, single stage) ----
FROM node:18

WORKDIR /app

# Install deps with clean, reproducible lockfile
COPY package*.json ./
RUN npm ci --omit=dev

# Copy app
COPY . .

# Make sure Node listens on all interfaces in containers
ENV HOST=0.0.0.0 \
    NODE_ENV=production \
    PORT=3000

EXPOSE 3000
CMD ["npm","start"]
